"use strict";var _options=null,trim=function(n){return n.replace(/^\s+/,"").replace(/\s+$/,"")},fs=require("fs"),path=require("path"),readLine=require("readline"),files=null,filePath=null,contents=null,writeFile=function(n){fs.writeFileSync(_options.output,n,function(n){if(n)throw n}),console.log("\u8bed\u8a00\u7f16\u8bd1\u5b8c\u6210")},findFiles=function c(f,l){if(0===l&&console.log("\u8bed\u8a00\u5f00\u59cb\u7f16\u8bd1..."),l===f.length)return contents=(contents=trim(contents)).substr(0,contents.length-1),void writeFile(contents+="\n  }\n}\nexport default i18n\n");var a=f[l],u=path.join(filePath,a);fs.stat(u,function(n,t){if(n)console.warn("\u83b7\u53d6\u6587\u4ef6stats\u5931\u8d25");else if(t.isFile()){var e=readLine.createInterface({input:fs.createReadStream(u)}),i=0,o=0,s=0,r=a.replace(/\.\w+/,"");if(".DS_Store"===f[l])return void c(f,++l);contents+="    ".concat(r,": {\n"),e.on("line",function(n){n&&0<=n.indexOf("'zh-CN': {")&&(i=s),n&&0<=n.indexOf("'zh-TW': {")&&(o=s),0<i&&i<s&&0===o&&n&&0!==n.length&&(contents+="  ".concat(n,"\r")),s++}),e.on("close",function(){console.log("\u7f16\u8bd1\u4e2d: ".concat(f[l])),c(f,++l)})}else c(f,l+=1)})};function MergeI18n(n){filePath=(_options=n).entry;try{fs.unlinkSync(n.output)}catch(n){}files=fs.readdirSync(filePath)}var travel=function e(i,o){fs.readdirSync(i).forEach(function(n){var t=path.join(i,n);fs.statSync(t).isDirectory()?e(t,o):o(t)})},modifyList=[];MergeI18n.prototype.apply=function(n){n.plugin("done",function(){contents="const i18n = {\n  zh_CN: {\n",modifyList=[],fs.access(_options.output,function(n){n?findFiles(files,0):(travel(_options.entry,function(n){fs.stat(n,function(n,t){modifyList.push(t.mtimeMs)})}),fs.stat(_options.output,function(n,t){t.mtimeMs<Math.max.apply(null,modifyList)&&findFiles(files,0)}))})})},module.exports=MergeI18n;